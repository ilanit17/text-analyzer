<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×× ×ª×— ×˜×§×¡×˜×™× ×œ×”×‘× ×ª ×”× ×§×¨×</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Heebo', sans-serif; }
        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
    <div id="app" class="p-4">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <div class="flex items-center justify-center gap-3 mb-2">
                    <span class="text-4xl">ğŸ“š</span>
                    <h1 class="text-3xl font-bold text-gray-800">×× ×ª×— ×˜×§×¡×˜×™× ×œ×”×‘× ×ª ×”× ×§×¨×</h1>
                </div>
                <p class="text-gray-600">×”×¢×œ×™ ×˜×§×¡×˜ ×•×§×‘×œ×™ ×”××œ×¦×•×ª ××•×ª×××•×ª ×œ××™××“×™ ×”×‘× ×” ×•××¡×˜×¨×˜×’×™×•×ª</p>
            </div>

            <!-- Input Section -->
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-xl">ğŸ“¤</span>
                    <h2 class="text-lg font-semibold">×”×–× ×ª ×˜×§×¡×˜</h2>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">×©×›×‘×ª ×’×™×œ:</label>
                    <select id="gradeLevel" class="w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="×‘">×›×™×ª×” ×‘×³</option>
                        <option value="×’">×›×™×ª×” ×’×³</option>
                        <option value="×“" selected>×›×™×ª×” ×“×³</option>
                        <option value="×”">×›×™×ª×” ×”×³</option>
                        <option value="×•">×›×™×ª×” ×•×³</option>
                    </select>
                </div>

                <textarea
                    id="textInput"
                    placeholder="×”×“×‘×™×§×™ ×›××Ÿ ××ª ×”×˜×§×¡×˜ ×œ× ×™×ª×•×—..."
                    class="w-full h-48 p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 resize-none text-right"
                ></textarea>
                
                <div class="flex justify-between items-center mt-4">
                    <span id="charCount" class="text-sm text-gray-500">0 ×ª×•×•×™×</span>
                    <button
                        id="analyzeBtn"
                        onclick="analyzeText()"
                        class="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105"
                    >
                        <span>âœ¨</span> × ×ª×— ×˜×§×¡×˜
                    </button>
                </div>

                <div id="error" class="hidden mt-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700 text-sm"></div>
            </div>

            <!-- Results Section -->
            <div id="results" class="hidden space-y-6"></div>

            <!-- Quick Reference (shown when no results) -->
            <div id="quickRef" class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h3 class="font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <span>ğŸ¯</span>
                        ××™××“×™ ×”×‘× ×”
                    </h3>
                    <div class="space-y-2">
                        <div class="p-3 rounded-lg border bg-blue-100 border-blue-300"><div class="font-medium flex items-center gap-2"><span>ğŸ“</span>×™×“×¢ ×œ×©×•× ×™</div></div>
                        <div class="p-3 rounded-lg border bg-green-100 border-green-300"><div class="font-medium flex items-center gap-2"><span>ğŸ‘ï¸</span>×”×‘× ×ª ×ª×•×›×Ÿ ×’×œ×•×™</div></div>
                        <div class="p-3 rounded-lg border bg-purple-100 border-purple-300"><div class="font-medium flex items-center gap-2"><span>ğŸ”</span>×”×‘× ×ª ×¨×¢×™×•× ×•×ª ×¡××•×™×™×</div></div>
                        <div class="p-3 rounded-lg border bg-yellow-100 border-yellow-300"><div class="font-medium flex items-center gap-2"><span>ğŸ’¡</span>×¤×¨×©× ×•×ª ×•×™×™×©×•×</div></div>
                        <div class="p-3 rounded-lg border bg-orange-100 border-orange-300"><div class="font-medium flex items-center gap-2"><span>âš–ï¸</span>×”×¢×¨×›×” ×•×‘×™×§×•×¨×ª</div></div>
                    </div>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h3 class="font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <span>ğŸ§­</span>
                        ××¡×˜×¨×˜×’×™×•×ª ×§×¨×™××”
                    </h3>
                    <div class="space-y-2">
                        <div class="p-3 rounded-lg border bg-teal-100 border-teal-300"><div class="font-medium flex items-center gap-2"><span>ğŸ¯</span>×œ×¤× ×™ ×”×§×¨×™××”</div></div>
                        <div class="p-3 rounded-lg border bg-indigo-100 border-indigo-300"><div class="font-medium flex items-center gap-2"><span>ğŸ“–</span>×‘××”×œ×š ×”×§×¨×™××”</div></div>
                        <div class="p-3 rounded-lg border bg-pink-100 border-pink-300"><div class="font-medium flex items-center gap-2"><span>âœ…</span>××—×¨×™ ×”×§×¨×™××”</div></div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center mt-8 text-sm text-gray-500">
                <p>××‘×•×¡×¡ ×¢×œ ×”××•×“×œ ×©×œ ××™×œ× ×™×ª ×©×•×•×¨×¥ ×œ×”×•×¨××ª ×”×‘× ×ª ×”× ×§×¨×</p>
            </div>
        </div>
    </div>

    <script>
        // Update character count
        document.getElementById('textInput').addEventListener('input', function() {
            document.getElementById('charCount').textContent = this.value.length + ' ×ª×•×•×™×';
        });

        async function analyzeText() {
            const text = document.getElementById('textInput').value.trim();
            const gradeLevel = document.getElementById('gradeLevel').value;
            const errorDiv = document.getElementById('error');
            const resultsDiv = document.getElementById('results');
            const quickRefDiv = document.getElementById('quickRef');
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (!text) {
                errorDiv.textContent = '× × ×œ×”×–×™×Ÿ ×˜×§×¡×˜ ×œ× ×™×ª×•×—';
                errorDiv.classList.remove('hidden');
                return;
            }

            errorDiv.classList.add('hidden');
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<span class="spinner inline-block">â³</span> ×× ×ª×—...';

            const prompt = `××ª×” ××•××—×” ×œ×”×•×¨××ª ×§×¨×™××” ×•×”×‘× ×ª ×”× ×§×¨× ×‘×¢×‘×¨×™×ª ×œ×‘×™×ª ×”×¡×¤×¨ ×”×™×¡×•×“×™.

× ×ª×— ××ª ×”×˜×§×¡×˜ ×”×‘× ×¢×‘×•×¨ ×ª×œ××™×“×™ ×›×™×ª×” ${gradeLevel} ×•×”××œ×¥ ×¢×œ:
1. ××™××“×™ ×”×‘× ×” ××ª××™××™× ×œ×¢×‘×•×“×” ×¢× ×”×˜×§×¡×˜
2. ××¡×˜×¨×˜×’×™×•×ª ×”×‘× ×ª ×”× ×§×¨× ××ª××™××•×ª
3. ×©××œ×•×ª ×œ×“×•×’××” ×œ×›×œ ××™××“

×”×˜×§×¡×˜ ×œ× ×™×ª×•×—:
"""
${text}
"""

×”×—×–×¨ ×ª×©×•×‘×” ×‘×¤×•×¨××˜ JSON ×‘×œ×‘×“ (×œ×œ× markdown ××• ×”×¡×‘×¨×™× × ×•×¡×¤×™×) ×œ×¤×™ ×”××‘× ×” ×”×‘×:
{
  "textAnalysis": {
    "type": "×¡×•×’ ×”×˜×§×¡×˜ (×¡×™×¤×•×¨×™/××™×“×¢×™/×˜×™×¢×•× ×™/×©×™×¨×”)",
    "complexity": "×¨××ª ××•×¨×›×‘×•×ª (×§×œ/×‘×™× ×•× ×™/×××ª×’×¨)",
    "mainThemes": ["× ×•×©× 1", "× ×•×©× 2"],
    "specialFeatures": ["×××¤×™×™×Ÿ 1", "×××¤×™×™×Ÿ 2"]
  },
  "recommendedDimensions": [
    {
      "dimension": "×©× ×”××™××“",
      "relevance": "×’×‘×•×”×”/×‘×™× ×•× ×™×ª",
      "reason": "×”×¡×‘×¨ ×§×¦×¨ ×œ××” ××ª××™×",
      "sampleQuestions": ["×©××œ×” 1", "×©××œ×” 2"]
    }
  ],
  "recommendedStrategies": [
    {
      "strategy": "×©× ×”××¡×˜×¨×˜×’×™×”",
      "tool": "×©× ×”×›×œ×™ ×”××ª××™×",
      "when": "×œ×¤× ×™ ×”×§×¨×™××”/×‘××”×œ×š ×”×§×¨×™××”/××—×¨×™ ×”×§×¨×™××”",
      "howToUse": "×”×¡×‘×¨ ×§×¦×¨ ×œ×©×™××•×©"
    }
  ],
  "teachingTips": ["×˜×™×¤ 1", "×˜×™×¤ 2", "×˜×™×¤ 3"]
}`;

            try {
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 2000,
                        messages: [{ role: 'user', content: prompt }]
                    })
                });

                const data = await response.json();
                const content = data.content[0].text;
                
                const jsonMatch = content.match(/\{[\s\S]*\}/);
                if (jsonMatch) {
                    const analysis = JSON.parse(jsonMatch[0]);
                    displayResults(analysis);
                    quickRefDiv.classList.add('hidden');
                    resultsDiv.classList.remove('hidden');
                } else {
                    throw new Error('×œ× ×”×ª×§×‘×œ×” ×ª×©×•×‘×” ×ª×§×™× ×”');
                }
            } catch (err) {
                errorDiv.textContent = '×©×’×™××” ×‘× ×™×ª×•×— ×”×˜×§×¡×˜. × ×¡×™ ×©×•×‘.';
                errorDiv.classList.remove('hidden');
                console.error(err);
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<span>âœ¨</span> × ×ª×— ×˜×§×¡×˜';
            }
        }

        function displayResults(analysis) {
            const resultsDiv = document.getElementById('results');
            
            const complexityColors = {
                '×§×œ': 'bg-green-100 text-green-800 border-green-300',
                '×‘×™× ×•× ×™': 'bg-yellow-100 text-yellow-800 border-yellow-300',
                '×××ª×’×¨': 'bg-red-100 text-red-800 border-red-300'
            };

            const relevanceColors = {
                '×’×‘×•×”×”': 'bg-green-500 text-white',
                '×‘×™× ×•× ×™×ª': 'bg-yellow-500 text-white'
            };

            const phaseColors = {
                '×œ×¤× ×™ ×”×§×¨×™××”': 'bg-teal-50 border-teal-200',
                '×‘××”×œ×š ×”×§×¨×™××”': 'bg-indigo-50 border-indigo-200',
                '××—×¨×™ ×”×§×¨×™××”': 'bg-pink-50 border-pink-200'
            };

            const phaseIcons = {
                '×œ×¤× ×™ ×”×§×¨×™××”': 'ğŸ¯',
                '×‘××”×œ×š ×”×§×¨×™××”': 'ğŸ“–',
                '××—×¨×™ ×”×§×¨×™××”': 'âœ…'
            };

            let html = `
                <!-- Text Analysis Overview -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="text-xl">ğŸ‘ï¸</span>
                        <h2 class="text-lg font-semibold">×¡×§×™×¨×ª ×”×˜×§×¡×˜</h2>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-gray-50 rounded-xl p-4 text-center">
                            <div class="text-sm text-gray-500 mb-1">×¡×•×’ ×”×˜×§×¡×˜</div>
                            <div class="font-semibold text-gray-800">${analysis.textAnalysis?.type || ''}</div>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4 text-center">
                            <div class="text-sm text-gray-500 mb-1">×¨××ª ××•×¨×›×‘×•×ª</div>
                            <span class="px-3 py-1 rounded-full text-sm font-medium border ${complexityColors[analysis.textAnalysis?.complexity] || complexityColors['×‘×™× ×•× ×™']}">${analysis.textAnalysis?.complexity || ''}</span>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4 col-span-2">
                            <div class="text-sm text-gray-500 mb-1">× ×•×©××™× ××¨×›×–×™×™×</div>
                            <div class="flex flex-wrap gap-2">
                                ${(analysis.textAnalysis?.mainThemes || []).map(theme => 
                                    `<span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">${theme}</span>`
                                ).join('')}
                            </div>
                        </div>
                    </div>

                    ${analysis.textAnalysis?.specialFeatures?.length ? `
                        <div class="mt-4 p-3 bg-purple-50 rounded-xl">
                            <div class="text-sm font-medium text-purple-800 mb-2">×××¤×™×™× ×™× ××™×•×—×“×™×:</div>
                            <div class="flex flex-wrap gap-2">
                                ${analysis.textAnalysis.specialFeatures.map(feature => 
                                    `<span class="px-2 py-1 bg-purple-100 text-purple-800 rounded-lg text-sm">âœ¨ ${feature}</span>`
                                ).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>

                <!-- Recommended Dimensions -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="text-xl">ğŸ¯</span>
                        <h2 class="text-lg font-semibold">××™××“×™ ×”×‘× ×” ××•××œ×¦×™×</h2>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">${analysis.recommendedDimensions?.length || 0}</span>
                    </div>
                    
                    <div class="space-y-4">
                        ${(analysis.recommendedDimensions || []).map(dim => `
                            <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow">
                                <div class="flex items-start justify-between mb-2">
                                    <h3 class="font-semibold text-gray-800 flex items-center gap-2">
                                        <span>ğŸ§ </span>
                                        ${dim.dimension}
                                    </h3>
                                    <span class="px-2 py-1 rounded-full text-xs font-medium ${relevanceColors[dim.relevance] || relevanceColors['×‘×™× ×•× ×™×ª']}">${dim.relevance}</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">${dim.reason}</p>
                                
                                ${dim.sampleQuestions?.length ? `
                                    <div class="bg-blue-50 rounded-lg p-3">
                                        <div class="text-xs font-medium text-blue-800 mb-2">×©××œ×•×ª ×œ×“×•×’××”:</div>
                                        <ul class="space-y-1">
                                            ${dim.sampleQuestions.map(q => 
                                                `<li class="text-sm text-blue-900 flex items-start gap-2">
                                                    <span class="text-blue-500">â€¢</span>
                                                    ${q}
                                                </li>`
                                            ).join('')}
                                        </ul>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Recommended Strategies -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="text-xl">ğŸ§­</span>
                        <h2 class="text-lg font-semibold">××¡×˜×¨×˜×’×™×•×ª ××•××œ×¦×•×ª</h2>
                        <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">${analysis.recommendedStrategies?.length || 0}</span>
                    </div>
                    
                    <div class="grid gap-4">
                        ${['×œ×¤× ×™ ×”×§×¨×™××”', '×‘××”×œ×š ×”×§×¨×™××”', '××—×¨×™ ×”×§×¨×™××”'].map(phase => {
                            const phaseStrategies = (analysis.recommendedStrategies || []).filter(s => s.when === phase);
                            if (!phaseStrategies.length) return '';
                            
                            return `
                                <div class="rounded-xl p-4 border ${phaseColors[phase]}">
                                    <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                                        ${phaseIcons[phase]} ${phase}
                                    </h4>
                                    <div class="space-y-3">
                                        ${phaseStrategies.map(strat => `
                                            <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-medium text-gray-800">${strat.strategy}</div>
                                                ${strat.tool ? `<div class="text-sm text-purple-600 mt-1">ğŸ”§ ×›×œ×™: ${strat.tool}</div>` : ''}
                                                <div class="text-sm text-gray-600 mt-1">${strat.howToUse}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <!-- Teaching Tips -->
                ${analysis.teachingTips?.length ? `
                    <div class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl shadow-lg p-6">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="text-xl">ğŸ’¡</span>
                            <h2 class="text-lg font-semibold text-gray-800">×˜×™×¤×™× ×œ×”×•×¨××”</h2>
                        </div>
                        <div class="space-y-2">
                            ${analysis.teachingTips.map(tip => `
                                <div class="flex items-start gap-3 bg-white/70 rounded-lg p-3">
                                    <span class="text-yellow-500 text-lg">ğŸ’¡</span>
                                    <span class="text-gray-700">${tip}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
            `;

            resultsDiv.innerHTML = html;
        }
    </script>
</body>
</html>
